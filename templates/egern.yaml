---
# Egern èšåˆè®¢é˜…æ¨¡æ¿ï¼ˆå¯ä¸ CF-Workers-SUB / subconverter ä¸€èµ·ä½¿ç”¨ï¼‰ã€‚
# ç”¨æ³•ç¤ºä¾‹ï¼šåœ¨èšåˆå‡ºçš„è®¢é˜…åé™„åŠ  target=egern å¹¶è¿½åŠ  config æŒ‡å‘æœ¬æ–‡ä»¶ï¼š
#   https://sub.example.com/auto?token=YOUR_TOKEN&target=egern&config=https://raw.githubusercontent.com/LUCK777777/clash-rule/refs/heads/main/templates/egern.yaml
# è‹¥ç›´æ¥å¯¼å…¥åˆ° Egernï¼Œå¯åœ¨ Profile.yaml ä¸­å°† auto_update.url æ›¿æ¢ä¸ºä½ çš„èšåˆè®¢é˜…åœ°å€ã€‚

# è‡ªåŠ¨æ›´æ–°é…ç½®ï¼šæŠŠ url æ”¹æˆä½ åœ¨ CF-Workers-SUB è¾“å‡ºçš„èšåˆè®¢é˜…åœ°å€ï¼Œç¡®ä¿å®¢æˆ·ç«¯è‡ªåŠ¨æ‹‰å–æœ€æ–°èŠ‚ç‚¹ã€‚
auto_update:
  url: https://sub.example.com/auto?token=YOUR_TOKEN&target=egern
  interval: 86400

# é€šç”¨å¼€å…³
mode: rule
log-level: info
ipv6: false
allow_external_connections: false
vif_only: false
hide_vpn_icon: false

# DNS é˜²æ³„æ¼ï¼šä½¿ç”¨ egern æ¨èçš„åˆ†æµä¸å›é€€é…ç½®ï¼Œé…åˆ hijack é˜»æ–­ç³»ç»Ÿç›´è¿
dns:
  bootstrap:
    - 223.5.5.5
    - 119.29.29.29

  upstreams:
    å›½å¤–:
      - tls://1.1.1.1
      - https://8.8.8.8/dns-query
      - https://1.1.1.1/dns-query
      - tls://dns.google
    å›½å†…:
      - tls://dns.alidns.com
      - tls://dot.pub
      - https://doh.pub/dns-query
      - https://dns.alidns.com/dns-query
    è…¾è®¯:
      - tls://dot.pub
      - https://doh.pub/dns-query
    é˜¿é‡Œå·´å·´:
      - tls://dns.alidns.com
      - https://dns.alidns.com/dns-query
    å­—èŠ‚è·³åŠ¨:
      - 180.184.2.2
      - 180.184.1.1

  forward:
    - proxy_rule_set:
        match: https://rule.kelee.one/Loon/DouYin.lsr
        value: å­—èŠ‚è·³åŠ¨
        disabled: false
    - proxy_rule_set:
        match: https://rule.kelee.one/Loon/TestFlight.lsr
        value: å›½å¤–
        disabled: false
    - proxy_rule_set:
        match: https://rule.kelee.one/Loon/Apple.lsr
        value: å›½å†…
        disabled: false
    - proxy_rule_set:
        match: https://rule.kelee.one/Loon/Alibaba.lsr
        value: é˜¿é‡Œå·´å·´
        disabled: false
    - proxy_rule_set:
        match: https://rule.kelee.one/Loon/Tencent.lsr
        value: è…¾è®¯
        disabled: false
    - proxy_rule_set:
        match: https://rule.kelee.one/Loon/ChinaMax.lsr
        value: å›½å†…
        disabled: false
    - proxy_rule_set:
        match: https://rule.kelee.one/Loon/Global.lsr
        value: å›½å¤–
        disabled: false
    - wildcard:
        match: "*"
        value: å›½å¤–
        disabled: false

  public_ip_lookup_url: https://ifconfig.me/ip

# å°†å¤–éƒ¨ DNS è¯·æ±‚åŠ«æŒåˆ°å†…æ ¸ï¼Œé…åˆä¸Šæ–¹çš„ forward é¿å…æ³„æ¼
hijack_dns:
  - '*'

# èŠ‚ç‚¹ä¸åˆ†æµç­–ç•¥ç»„ï¼šé»˜è®¤ä¿ç•™ç›´è¿å¤‡é€‰ï¼Œè®¢é˜…èŠ‚ç‚¹ä¼šè¿½åŠ åˆ°å„ç»„ï¼Œå¯æŒ‰éœ€è°ƒæ•´æµ‹é€Ÿ URL
proxy_latency_test_url: https://www.gstatic.com/generate_204
proxy_latency_test_interval: 600
proxy_latency_test_tolerance: 50

direct_latency_test_url: https://www.baidu.com

dns_hijack_latency_test_url: https://1.1.1.1/dns-query

dns_hijack_latency_test_tolerance: 200

dns_hijack_latency_test_interval: 600

proxy_groups:
  - name: "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
    type: select
    proxies:
      - "â™»ï¸ è‡ªåŠ¨é€‰æ‹©"
      - "ğŸ¯ å…¨çƒç›´è¿"
      - "DIRECT"

  - name: "â™»ï¸ è‡ªåŠ¨é€‰æ‹©"
    type: url-test
    url: "https://www.gstatic.com/generate_204"
    interval: 600
    tolerance: 50

  - name: "ğŸ”° å›½å¤–æµé‡"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "DIRECT"

  - name: "ğŸŒ æµåª’ä½“"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ”° å›½å¤–æµé‡"
      - "DIRECT"

  - name: "ğŸ è‹¹æœæœåŠ¡"
    type: select
    proxies:
      - "ğŸ¯ å…¨çƒç›´è¿"
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "DIRECT"

  - name: "â“‚ï¸ å¾®è½¯æœåŠ¡"
    type: select
    proxies:
      - "ğŸ¯ å…¨çƒç›´è¿"
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "DIRECT"

  - name: "ğŸ“² ç”µæŠ¥ä¿¡æ¯"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ”° å›½å¤–æµé‡"
      - "DIRECT"

  - name: "ğŸ¥ YouTube"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ”° å›½å¤–æµé‡"
      - "DIRECT"

  - name: "ğŸ¬ å¥ˆé£è§†é¢‘"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ”° å›½å¤–æµé‡"
      - "DIRECT"

  - name: "ğŸª€ TikTok"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ”° å›½å¤–æµé‡"
      - "DIRECT"

  - name: "ğŸ§¸ Spotify"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ”° å›½å¤–æµé‡"
      - "DIRECT"

  - name: "ğŸ“º Disney Plus"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ”° å›½å¤–æµé‡"
      - "DIRECT"

  - name: "ğŸ® æ¸¸æˆå¹³å°"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ¯ å…¨çƒç›´è¿"
      - "DIRECT"

  - name: "ğŸ¯ å…¨çƒç›´è¿"
    type: select
    proxies:
      - "DIRECT"
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"

  - name: "ğŸ›‘ å…¨çƒæ‹¦æˆª"
    type: select
    proxies:
      - "REJECT"

  - name: "ğŸŸ æ¼ç½‘ä¹‹é±¼"
    type: select
    proxies:
      - "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
      - "ğŸ”° å›½å¤–æµé‡"
      - "ğŸ¯ å…¨çƒç›´è¿"

# åŸºäº blackmatrix7 Clash è§„åˆ™çš„ rule-providersï¼Œå®šæ—¶ä»é•œåƒæ›´æ–°ï¼Œä¿è¯ Egern ä¸ä¸Šæ¸¸ä¿æŒåŒæ­¥
rule_providers:
  AdvertisingLite:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/AdvertisingLite/AdvertisingLite.yaml
    path: ./rules/AdvertisingLite.yaml
    interval: 86400

  Hijacking:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Hijacking/Hijacking.yaml
    path: ./rules/Hijacking.yaml
    interval: 86400

  Apple:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Apple/Apple.yaml
    path: ./rules/Apple.yaml
    interval: 86400

  Microsoft:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Microsoft/Microsoft.yaml
    path: ./rules/Microsoft.yaml
    interval: 86400

  Google:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Google/Google.yaml
    path: ./rules/Google.yaml
    interval: 86400

  Telegram:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml
    path: ./rules/Telegram.yaml
    interval: 86400

  YouTube:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/YouTube/YouTube.yaml
    path: ./rules/YouTube.yaml
    interval: 86400

  Netflix:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Netflix/Netflix.yaml
    path: ./rules/Netflix.yaml
    interval: 86400

  Disney:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Disney/Disney.yaml
    path: ./rules/Disney.yaml
    interval: 86400

  TikTok:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/TikTok/TikTok.yaml
    path: ./rules/TikTok.yaml
    interval: 86400

  Spotify:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Spotify/Spotify.yaml
    path: ./rules/Spotify.yaml
    interval: 86400

  Facebook:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Facebook/Facebook.yaml
    path: ./rules/Facebook.yaml
    interval: 86400

  Twitter:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Twitter/Twitter.yaml
    path: ./rules/Twitter.yaml
    interval: 86400

  Steam:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Steam/Steam.yaml
    path: ./rules/Steam.yaml
    interval: 86400

  Speedtest:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Speedtest/Speedtest.yaml
    path: ./rules/Speedtest.yaml
    interval: 86400

  GlobalMedia:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/GlobalMedia/GlobalMedia.yaml
    path: ./rules/GlobalMedia.yaml
    interval: 86400

  ChinaMedia:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/ChinaMedia/ChinaMedia.yaml
    path: ./rules/ChinaMedia.yaml
    interval: 86400

  China:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/China/China.yaml
    path: ./rules/China.yaml
    interval: 86400

  Proxy:
    type: http
    behavior: classical
    url: https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Proxy/Proxy.yaml
    path: ./rules/Proxy.yaml
    interval: 86400

rules:
  - RULE-SET,AdvertisingLite,ğŸ›‘ å…¨çƒæ‹¦æˆª
  - RULE-SET,Hijacking,ğŸ›‘ å…¨çƒæ‹¦æˆª
  - RULE-SET,Apple,ğŸ è‹¹æœæœåŠ¡
  - RULE-SET,Microsoft,â“‚ï¸ å¾®è½¯æœåŠ¡
  - RULE-SET,Telegram,ğŸ“² ç”µæŠ¥ä¿¡æ¯
  - RULE-SET,YouTube,ğŸ¥ YouTube
  - RULE-SET,Netflix,ğŸ¬ å¥ˆé£è§†é¢‘
  - RULE-SET,Disney,ğŸ“º Disney Plus
  - RULE-SET,TikTok,ğŸª€ TikTok
  - RULE-SET,Spotify,ğŸ§¸ Spotify
  - RULE-SET,Facebook,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,Twitter,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,Steam,ğŸ® æ¸¸æˆå¹³å°
  - RULE-SET,Speedtest,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,GlobalMedia,ğŸŒ æµåª’ä½“
  - RULE-SET,Google,ğŸ”° å›½å¤–æµé‡
  - RULE-SET,ChinaMedia,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,China,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,Proxy,ğŸ”° å›½å¤–æµé‡
  - GEOIP,CN,ğŸ¯ å…¨çƒç›´è¿,no-resolve
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼

# DNS é˜²æ³„æ¼ï¼šåŠ«æŒæ‰€æœ‰å¤–éƒ¨ DNS è¯·æ±‚å¹¶é€å…¥å†…æ ¸è§£æ
dns:
  bootstrap:
    - system
    - https://1.1.1.1/dns-query
  upstreams:
    main:
      - https://1.1.1.1/dns-query
      - https://8.8.8.8/dns-query
    security:
      - quic://dns.adguard-dns.com
  forward:
    - wildcard:
        match: '*.lan'
        value: system
    - wildcard:
        match: '*.local'
        value: system
    - proxy_rule_set:
        match: https://raw.githubusercontent.com/ACL4SSR/ACL4SSR/master/Clash/ChinaDomain.list
        value: system
    - wildcard:
        match: '*'
        value: main
  block_ips:
    - 0.0.0.0/8
    - 10.0.0.0/8
    - 100.64.0.0/10
    - 127.0.0.0/8
    - 169.254.0.0/16
    - 172.16.0.0/12
    - 192.0.0.0/24
    - 192.0.2.0/24
    - 192.168.0.0/16
    - 198.18.0.0/15
    - 198.51.100.0/24
    - 203.0.113.0/24
    - 224.0.0.0/4
    - 240.0.0.0/4
  public_ip_lookup_url: https://ifconfig.me/ip

# å°†å¤–éƒ¨ DNS è¯·æ±‚åŠ«æŒåˆ°å†…æ ¸ï¼Œé…åˆä¸Šæ–¹çš„ forward ä¸ block_ips é¿å…æ³„æ¼
hijack_dns:
  - '*'

# å»¶è¿Ÿæµ‹è¯•ï¼šèšåˆèŠ‚ç‚¹æ± çš„å¿«é€Ÿå¥åº·æ£€æŸ¥ï¼ˆå¯æ ¹æ®éœ€è¦è°ƒæ•´ URLï¼‰
proxy_latency_test_url: https://www.gstatic.com/generate_204
direct_latency_test_url: https://www.baidu.com

# ç½‘ç»œåŒ…å«é€‰é¡¹ï¼šå¼€å¯åå¯è¦†ç›–èœ‚çªã€APNs ä¸æœ¬åœ°ç½‘ç»œï¼Œä¿è¯æ‰€æœ‰æµé‡å‡çº³å…¥ç­–ç•¥ç®¡æ§
include_all_networks: true
include_apns: true
include_cellular_services: true
include_local_networks: true

# å…¼å®¹è·¯ç”±ï¼šå¦‚é‡åˆ°æœ¬åœ°ç½‘ç»œè®¾å¤‡å¼‚å¸¸ï¼ˆå¦‚ HomeKit å½•åƒï¼‰ï¼Œå¯æ”¹ä¸º true
compat_route: false
